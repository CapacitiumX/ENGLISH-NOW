<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#8b5cf6">
    <meta name="apple-mobile-web-app-title" content="Profe Ingl√©s">
    
    <title>NeuroLingua Pro - CapacitiumX</title>

    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/3426/3426224.png">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3426/3426224.png">

    <script>
        const myManifest = {
            "name": "NeuroLingua Profe Ingl√©s",
            "short_name": "Ingl√©s Pro",
            "start_url": "./index.html",
            "display": "standalone",
            "orientation": "any",
            "background_color": "#0f172a",
            "theme_color": "#8b5cf6",
            "icons": [
                {
                    "src": "https://cdn-icons-png.flaticon.com/512/3426/3426224.png",
                    "sizes": "512x512",
                    "type": "image/png",
                    "purpose": "any maskable"
                }
            ]
        };
        const stringManifest = JSON.stringify(myManifest);
        const blob = new Blob([stringManifest], {type: 'application/json'});
        const manifestURL = URL.createObjectURL(blob);
        const link = document.createElement('link');
        link.rel = 'manifest';
        link.href = manifestURL;
        document.head.appendChild(link);
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        :root {
            --primary: #8b5cf6; --accent: #06b6d4; --dark: #0f172a; --panel: #1e293b;
            --text: #f1f5f9; --green: #22c55e; --red: #ef4444;
        }
        
        /* Ajuste para permitir Scroll en toda la p√°gina */
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: var(--dark); 
            color: var(--text); 
            margin: 0; 
            min-height: 100vh;
            overflow-y: auto; /* Permite scroll vertical */
        }

        .layout { display: flex; flex-direction: row; width: 100%; min-height: 100vh; }
        
        /* PANEL IZQUIERDO */
        .left-panel { 
            width: 350px; 
            background: var(--panel); 
            border-right: 1px solid #334155; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            gap: 15px;
        }

        /* RESPONSIVO M√ìVIL */
        @media (max-width: 800px) {
            .layout { flex-direction: column; }
            .left-panel { width: 100%; box-sizing: border-box; border-right: none; border-bottom: 2px solid #334155; }
            .flashcard { height: auto !important; min-height: 400px; }
        }

        .brand { font-size: 1.5rem; font-weight: 900; color: var(--accent); text-align: center; letter-spacing: 2px; }
        
        .config-box { background: rgba(0,0,0,0.3); padding: 15px; border-radius: 12px; border: 1px solid #334155; }
        
        button { cursor: pointer; padding: 12px; border-radius: 8px; border: none; font-weight: bold; color: white; transition: 0.3s; margin-bottom: 5px; }
        button:active { transform: scale(0.95); }

        .btn-purple { background: var(--primary); width: 100%; }
        .btn-green { background: var(--green); width: 100%; }
        .btn-red { background: var(--red); width: 100%; }

        /* AREA DE LA TARJETA (FLASHCARD) */
        .right-panel { flex: 1; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        .flashcard { 
            width: 100%; 
            max-width: 550px; 
            background: #1e293b; 
            border-radius: 25px; 
            overflow: hidden; 
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }

        .img-area { width: 100%; height: 250px; background: #000; display: flex; align-items: center; justify-content: center; }
        .real-img { width: 100%; height: 100%; object-fit: cover; }
        
        .info-area { padding: 25px; text-align: center; }
        .word-en { font-size: 3rem; font-weight: 900; margin: 0; color: white; }
        .word-es { font-size: 2rem; color: var(--accent); margin: 10px 0; font-weight: bold; }

        .eval-bar { display: flex; gap: 15px; width: 100%; max-width: 550px; }
        .btn-eval { flex: 1; padding: 15px; font-size: 1rem; border-radius: 12px; }

        /* LISTA DE PALABRAS ABAJO */
        #visualList { margin-top: 15px; max-height: 300px; overflow-y: auto; border: 1px solid #334155; border-radius: 8px; }
        .list-item { padding: 10px; border-bottom: 1px solid #334155; cursor: pointer; }
        .list-item:hover { background: #334155; }
    </style>
</head>
<body>

<div class="layout">
    <div class="left-panel">
        <div class="brand">NEUROLINGUA</div>
        <div class="config-box">
            <button class="btn-purple" onclick="openModal()">+ CARGAR PALABRAS</button>
            <button class="btn-green" style="margin-top:10px" onclick="generatePDF()">üìÑ DESCARGAR PDF</button>
        </div>
        <div id="visualList"></div>
        <button class="btn-red" onclick="localStorage.clear(); location.reload();">VACIAR TODO</button>
    </div>

    <div class="right-panel">
        <div class="flashcard">
            <div class="img-area"><img id="cardImg" class="real-img" src="https://via.placeholder.com/500?text=NeuroLingua" alt="Cargando"></div>
            <div class="info-area">
                <h1 id="wordEn" class="word-en">Hello!</h1>
                <div id="wordEs" class="word-es">Hola</div>
                <div style="color: #94a3b8; font-style: italic;" id="sentence">Carga palabras para empezar a estudiar.</div>
            </div>
        </div>

        <div class="eval-bar">
            <button class="btn-red btn-eval" onclick="nextCard()">‚ùå NO LA S√â</button>
            <button class="btn-green btn-eval" onclick="nextCard()">‚úÖ APRENDIDA</button>
        </div>
    </div>
</div>

<div id="modalLoad" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:999; justify-content:center; align-items:center;">
    <div style="background:var(--panel); padding:25px; border-radius:20px; width:90%; max-width:500px; border:1px solid var(--primary);">
        <h3 style="margin-top:0">Pegar Lista</h3>
        <textarea id="bulkText" style="height:200px; width:100%; background:#0f172a; color:white; border:1px solid #334155; padding:10px; box-sizing:border-box;" placeholder="Apple&#10;House&#10;Car"></textarea>
        <div style="display:flex; gap:10px; margin-top:15px;">
            <button class="btn-red" style="flex:1" onclick="document.getElementById('modalLoad').style.display='none'">Cerrar</button>
            <button class="btn-green" style="flex:1" onclick="processBulk()">CARGAR ‚ö°</button>
        </div>
    </div>
</div>

<script>
    let app = { fullList: [], index: 0 };

    function openModal() { document.getElementById('modalLoad').style.display = 'flex'; }

    function processBulk() {
        const txt = document.getElementById('bulkText').value;
        const lines = txt.split('\n');
        lines.forEach(w => {
            w = w.trim();
            if(w.length > 1) {
                app.fullList.push({
                    en: w, es: "Traduciendo...", 
                    img: `https://tse2.mm.bing.net/th?q=${encodeURIComponent(w)}+photography&w=500&h=500&c=7`
                });
            }
        });
        document.getElementById('modalLoad').style.display = 'none';
        updateCardUI();
        renderList();
    }

    function updateCardUI() {
        if(app.fullList.length === 0) return;
        const item = app.fullList[app.index];
        document.getElementById('wordEn').innerText = item.en;
        document.getElementById('wordEs').innerText = item.es;
        document.getElementById('cardImg').src = item.img;
        
        // Hablar en ingl√©s
        const msg = new SpeechSynthesisUtterance(item.en);
        msg.lang = 'en-US';
        window.speechSynthesis.speak(msg);
    }

    function renderList() {
        const container = document.getElementById('visualList');
        container.innerHTML = '';
        app.fullList.forEach((item, idx) => {
            const div = document.createElement('div');
            div.className = 'list-item';
            div.innerText = `${idx+1}. ${item.en}`;
            div.onclick = () => { app.index = idx; updateCardUI(); };
            container.appendChild(div);
        });
    }

    function nextCard() {
        app.index = (app.index + 1) % app.fullList.length;
        updateCardUI();
    }

    function generatePDF() {
        if(app.fullList.length === 0) return alert("Primero carga palabras");
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.text("Lista de Vocabulario - Profe Ingl√©s", 10, 10);
        app.fullList.forEach((item, i) => {
            doc.text(`${i+1}. ${item.en}`, 10, 20 + (i * 10));
        });
        doc.save("vocabulario.pdf");
    }

    // SERVICE WORKER PARA ACTIVAR BOT√ìN DE INSTALAR
    if ('serviceWorker' in navigator) {
        const sw = `
            self.addEventListener('install', e => e.waitUntil(caches.open('v1').then(c => c.addAll(['./']))));
            self.addEventListener('fetch', e => e.respondWith(fetch(e.request).catch(() => caches.match(e.request))));
        `;
        const blob = new Blob([sw], {type: 'text/javascript'});
        const url = URL.createObjectURL(blob);
        navigator.serviceWorker.register(url);
    }
</script>
</body>
</html>
